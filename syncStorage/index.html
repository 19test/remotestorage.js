<html>
<head>
<script src="syncStorage.js"></script>
<script>
//
// syncStorage.onStatus() - offline, readonly, sending, receiving, ok
// syncStorage.onUserAddress()
// syncStorage.setUserAddress()
// syncStorage.onItem(key, val)
// syncStorage.fetchItem(key)
// syncStorage.setItem(key, val)

var syncStorage = SyncStorage();
function start() {
	syncStorage.onStatus = function(val) {//will also be called at startup
		document.getElementById("readyState").innerHTML = val;
	}
	syncStorage.onUserAddress = function(val) {//will also be called at startup
		document.getElementById("userAddress").innerHTML = val;
	}
	syncStorage.onItem = function(key, val) {
		if(key == 'foo') {
			document.getElementById("divFoo").innerHTML = val;
		}
		if(key == 'bar') {
			document.getElementById("divBar").innerHTML = val;
		}
	}
	//force initial loading now, or whenever sync is established. Combine with syncStorage.onItem() for best results:
	connect();
}
function connect() {
	syncStorage.setUserAddress(document.getElementById("userAddress").value, 'sandwiches');
	syncStorage.fetchItem("foo");
	syncStorage.fetchItem("bar");
}
function setFoo() {
	syncStorage.setItem("foo", document.getElementById("foo").value);
}
function deleteFoo() {
	syncStorage.removeItem("foo");
}
function setBar() {
	syncStorage.setItem("bar", document.getElementById("bar").value);
}
function deleteBar() {
	syncStorage.removeItem("bar");
}

</script>
</head>
<body onload="start();">
Status: - not synced - [sign in]
Status: mich@dev.unhosted.org [take offline safely] [logout]
Status: mich@dev.unhosted.org -you can go offline now- [logout]
->until connection fails->
Status: mich@dev.unhosted.org -offline-
->until something changed->
Status: mich@dev.unhosted.org -unsaved- [try now]
->until connection is back->
Status: - working -
Status: mich@dev.unhosted.org [take offline safely] [logout]
Status: - offline, read-only -
       --locked elsewhere\      -----<-----unlock---------------
      /                   \    /                                \
NotSynced  ---sign in--->  Online  ---take offline safely---> Locked ---connection fails---> LockedOffline ---change something---> Unsaved
       \                    / \ \                                / \                               /                                   /
        <------logout------/-- \ \ -----------------------------/   <-----connection back---------/---  Working <---connection back---/
                                \ \
                                 \ *-connection fails---> ReadOnly
                                  ---connection back-------/					
actions:
connect()
disconnect()
lock()
unlock()
set()
get()
delete()

onItem: array of functions
onStatus() -> object {lock: me/other/false, connected: true/false, userAddress:..., sync:"idle"/"sending"/"receiving", error:false}

data format:
- UTF8 JSON {"..":".."}
- lock

local: as-is, plus "lock". setting "lock" key will give error

---
 -- -
- -
 -


</body>
</html>
SyncStorage test app. This app uses 2 keys: foo and bar. you can set values into each of them, and delete them if you want:
<hr>
Sync:
	<div id="readyState">?</div>
	<input type="text" id="userAddress" value="mich@dev.unhosted.org">
	<input type="submit" value="connect" onclick="connect();">
<hr>
Foo:
	<div id="divFoo">?</div>
	<input type="text" id="foo">
	<input type="submit" onclick="setFoo();" value="set"> 
	<input type="submit" onclick="deleteFoo();" value="del">
<hr>
Bar:
	<div id="divBar">?</div>
	<input type="text" id="bar">
	<input type="submit" onclick="setBar();" value="set">
	<input type="submit" onclick="deleteBar();" value="del">
